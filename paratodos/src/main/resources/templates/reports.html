<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Relat√≥rios - Sistema RH</title>
  <link rel="stylesheet" href="../static/styles/global.css">
  <link rel="stylesheet" href="../static/styles/dashboard.css">
  <link rel="stylesheet" href="../static/styles/components.css">
  <style>
    .reports-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: var(--spacing-4);
    }

    .report-card {
      background: white;
      border-radius: var(--radius-lg);
      padding: var(--spacing-5);
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--gray-200);
      cursor: pointer;
      transition: all 0.2s;
    }

    .report-card:hover {
      box-shadow: var(--shadow-md);
      transform: translateY(-2px);
      border-color: var(--primary-dark);
    }

    .report-icon {
      width: 56px;
      height: 56px;
      background: var(--gray-100);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      margin-bottom: var(--spacing-4);
    }

    .report-title {
      font-size: var(--font-size-lg);
      font-weight: 600;
      margin-bottom: var(--spacing-2);
    }

    .report-desc {
      font-size: var(--font-size-sm);
      color: var(--gray-500);
      margin-bottom: var(--spacing-4);
    }

    .report-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: var(--font-size-sm);
      color: var(--gray-400);
      padding-top: var(--spacing-3);
      border-top: 1px solid var(--gray-100);
    }

    .chart-container {
      background: white;
      border-radius: var(--radius-lg);
      padding: var(--spacing-5);
      box-shadow: var(--shadow-sm);
      margin-bottom: var(--spacing-4);
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--spacing-4);
    }

    .chart-title {
      font-size: var(--font-size-lg);
      font-weight: 600;
    }

    .chart-placeholder {
      height: 250px;
      background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-100) 100%);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--gray-400);
    }

    .kpi-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: var(--spacing-4);
      margin-bottom: var(--spacing-6);
    }

    .kpi-card {
      background: white;
      border-radius: var(--radius-lg);
      padding: var(--spacing-4);
      text-align: center;
      box-shadow: var(--shadow-sm);
    }

    .kpi-value {
      font-size: var(--font-size-2xl);
      font-weight: 700;
      color: var(--primary-dark);
    }

    .kpi-label {
      font-size: var(--font-size-sm);
      color: var(--gray-500);
    }

    .kpi-change {
      font-size: var(--font-size-xs);
      margin-top: var(--spacing-1);
    }

    .kpi-change.positive {
      color: var(--success-green);
    }

    .kpi-change.negative {
      color: var(--error-red);
    }
  </style>
</head>

<body>
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="logo">
        <img src="../static/assets/gruporhpaint.png" alt="logo_menu_lateral" height="60">
      </div>
    </div>
    <nav class="sidebar-nav">
      <a href="dashboard.html" class="nav-item">
        <span class="nav-text">Dashboard</span>
      </a>

      <div class="nav-section">Gest√£o de Pessoas</div>
      <a href="employees.html" class="nav-item">
        <span class="nav-text">Funcion√°rios</span>
      </a>
      <a href="departments.html" class="nav-item">
        <span class="nav-text">Departamentos</span>
      </a>
      <a href="positions.html" class="nav-item">
        <span class="nav-text">Cargos</span>
      </a>

      <div class="nav-section">Recursos Humanos</div>
      <a href="recruitment.html" class="nav-item">
        <span class="nav-text">Recrutamento</span>
      </a>
      <a href="training.html" class="nav-item">
        <span class="nav-text">Treinamentos</span>
      </a>
      <a href="performance.html" class="nav-item">
        <span class="nav-text">Avalia√ß√µes</span>
      </a>

      <div class="nav-section">Departamento Pessoal</div>
      <a href="payroll.html" class="nav-item">
        <span class="nav-text">Folha de Pagamento</span>
      </a>
      <a href="benefits.html" class="nav-item">
        <span class="nav-text">Benef√≠cios</span>
      </a>
      <a href="vacation.html" class="nav-item">
        <span class="nav-text">F√©rias</span>
      </a>
      <a href="timesheet.html" class="nav-item">
        <span class="nav-text">Ponto</span>
      </a>

      <div class="nav-section">Administra√ß√£o</div>
      <a href="reports.html" class="nav-item active">
        <span class="nav-text">Relat√≥rios</span>
      </a>
      <a href="settings.html" class="nav-item">
        <span class="nav-text">Configura√ß√µes</span>
      </a>
    </nav>
  </aside>


  <div class="main-content">
    <header class="topbar">
      <div class="topbar-left">
        <button class="mobile-menu-btn" id="mobileMenuBtn">‚ò∞</button>
        <h1>Relat√≥rios e Analytics</h1>
      </div>
      <div class="topbar-right">
        <div class="user-menu">
          <button class="user-button" id="userMenuButton">
            <span class="user-avatar" id="userAvatar">U</span>
            <span class="user-name" id="userName">Usu√°rio</span>
            <span class="user-arrow">‚ñº</span>
          </button>
          <div class="user-dropdown" id="userDropdown">
            <div class="user-info">
              <strong id="userFullName">Nome do Usu√°rio</strong>
              <small id="userProfile">Perfil</small>
            </div>
            <hr>
            <a href="#" class="dropdown-item">Meu Perfil</a>
            <a href="settings.html" class="dropdown-item">Configura√ß√µes</a>
            <hr>
            <a href="#" class="dropdown-item" id="logoutButton">Sair</a>
          </div>
        </div>
      </div>
    </header>

    <div class="content-area">
      <!-- Tabs -->
      <div class="tabs" style="margin-bottom: var(--spacing-6);">
        <button class="tab-btn active" onclick="showTab('dashboard')">Dashboard</button>
        <button class="tab-btn" onclick="showTab('relatorios')">Relat√≥rios</button>
        <button class="tab-btn" onclick="showTab('exportar')">Exportar Dados</button>
      </div>

      <!-- Tab Dashboard -->
      <div id="tabDashboard">
        <!-- KPIs -->
        <div class="kpi-row">
          <div class="kpi-card">
            <div class="kpi-value">248</div>
            <div class="kpi-label">Funcion√°rios</div>
            <div class="kpi-change positive">‚Üë 5 este m√™s</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-value">5.2%</div>
            <div class="kpi-label">Turnover</div>
            <div class="kpi-change negative">‚Üë 0.3%</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-value">R$ 2.1M</div>
            <div class="kpi-label">Folha Mensal</div>
            <div class="kpi-change positive">‚Üì 2.1%</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-value">18 dias</div>
            <div class="kpi-label">Tempo Contrata√ß√£o</div>
            <div class="kpi-change positive">‚Üì 3 dias</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-value">4.2</div>
            <div class="kpi-label">M√©dia Avalia√ß√µes</div>
            <div class="kpi-change positive">‚Üë 0.1</div>
          </div>
          <div class="kpi-card">
            <div class="kpi-value">92%</div>
            <div class="kpi-label">Satisfa√ß√£o</div>
            <div class="kpi-change positive">‚Üë 3%</div>
          </div>
        </div>

        <!-- Charts -->
        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: var(--spacing-4);">
          <div class="chart-container">
            <div class="chart-header">
              <h3 class="chart-title">Evolu√ß√£o do Headcount</h3><select class="form-select" style="width: auto;">
                <option>√öltimos 12 meses</option>
                <option>√öltimos 6 meses</option>
                <option>Este ano</option>
              </select>
            </div>
            <div class="chart-placeholder" id="headcountChart">
              <div style="width: 100%; height: 100%; padding: 20px;">
                <svg viewBox="0 0 400 200" style="width: 100%; height: 100%;">
                  <polyline fill="none" stroke="var(--primary-dark)" stroke-width="2"
                    points="0,180 40,170 80,165 120,160 160,155 200,145 240,140 280,130 320,125 360,115 400,100" />
                  <polyline fill="rgba(44,62,80,0.1)" stroke="none"
                    points="0,200 0,180 40,170 80,165 120,160 160,155 200,145 240,140 280,130 320,125 360,115 400,100 400,200" />
                </svg>
              </div>
            </div>
          </div>
          <div class="chart-container">
            <div class="chart-header">
              <h3 class="chart-title">Distribui√ß√£o por Departamento</h3>
            </div>
            <div style="padding: 20px;">
              <div style="margin-bottom: 12px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                  <span>Tecnologia</span><span>45</span>
                </div>
                <div style="height: 8px; background: var(--gray-200); border-radius: 4px;">
                  <div style="height: 100%; width: 45%; background: var(--primary-dark); border-radius: 4px;"></div>
                </div>
              </div>
              <div style="margin-bottom: 12px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                  <span>Opera√ß√µes</span><span>52</span>
                </div>
                <div style="height: 8px; background: var(--gray-200); border-radius: 4px;">
                  <div style="height: 100%; width: 52%; background: var(--primary-gray); border-radius: 4px;"></div>
                </div>
              </div>
              <div style="margin-bottom: 12px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                  <span>Comercial</span><span>35</span>
                </div>
                <div style="height: 8px; background: var(--gray-200); border-radius: 4px;">
                  <div style="height: 100%; width: 35%; background: var(--light-gray); border-radius: 4px;"></div>
                </div>
              </div>
              <div style="margin-bottom: 12px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                  <span>Financeiro</span><span>18</span>
                </div>
                <div style="height: 8px; background: var(--gray-200); border-radius: 4px;">
                  <div style="height: 100%; width: 18%; background: var(--success-green); border-radius: 4px;"></div>
                </div>
              </div>
              <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                  <span>RH</span><span>12</span>
                </div>
                <div style="height: 8px; background: var(--gray-200); border-radius: 4px;">
                  <div style="height: 100%; width: 12%; background: var(--warning-orange); border-radius: 4px;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-4); margin-top: var(--spacing-4);">
          <div class="chart-container">
            <div class="chart-header">
              <h3 class="chart-title">Turnover Mensal</h3>
            </div>
            <div class="chart-placeholder">
              <div
                style="display: flex; align-items: flex-end; justify-content: space-around; height: 100%; padding: 20px; gap: 10px;">
                <!-- ${['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'].map((m,i) => `<div style="text-align: center;"><div style="width: 24px; height: ${30 + Math.random() * 80}px; background: var(--primary-dark); border-radius: 4px 4px 0 0;"></div><small style="font-size: 10px;">${m}</small></div>`).join('')} -->
              </div>
            </div>
          </div>
          <div class="chart-container">
            <div class="chart-header">
              <h3 class="chart-title">Custo por Funcion√°rio</h3>
            </div>
            <div class="chart-placeholder">
              <div style="width: 100%; height: 100%; padding: 20px;">
                <svg viewBox="0 0 400 200" style="width: 100%; height: 100%;">
                  <polyline fill="none" stroke="var(--success-green)" stroke-width="2"
                    points="0,150 40,145 80,140 120,135 160,130 200,125 240,120 280,115 320,110 360,105 400,100" />
                </svg>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab Relat√≥rios -->
      <div id="tabRelatorios" style="display: none;">
        <div class="page-header">
          <h2 class="page-title">Relat√≥rios Dispon√≠veis</h2>
        </div>
        <div class="reports-grid" id="reportsGrid"></div>
      </div>

      <!-- Tab Exportar -->
      <div id="tabExportar" style="display: none;">
        <div class="page-header">
          <h2 class="page-title">Exportar Dados</h2>
        </div>
        <div class="card">
          <form id="exportForm">
            <div class="form-row form-row-2">
              <div class="form-group"><label class="form-label">Tipo de Dados</label><select class="form-select"
                  name="tipo">
                  <option>Funcion√°rios</option>
                  <option>Folha de Pagamento</option>
                  <option>Ponto</option>
                  <option>F√©rias</option>
                  <option>Avalia√ß√µes</option>
                  <option>Treinamentos</option>
                </select></div>
              <div class="form-group"><label class="form-label">Formato</label><select class="form-select"
                  name="formato">
                  <option>Excel (.xlsx)</option>
                  <option>CSV</option>
                  <option>PDF</option>
                  <option>JSON</option>
                </select></div>
            </div>
            <div class="form-row form-row-2">
              <div class="form-group"><label class="form-label">Data In√≠cio</label><input type="date" class="form-input"
                  name="inicio"></div>
              <div class="form-group"><label class="form-label">Data Fim</label><input type="date" class="form-input"
                  name="fim"></div>
            </div>
            <div class="form-group"><label class="form-label">Departamentos</label><select class="form-select"
                name="departamentos" multiple style="height: 100px;">
                <option>Todos</option>
                <option>Tecnologia</option>
                <option>RH</option>
                <option>Financeiro</option>
                <option>Comercial</option>
                <option>Opera√ß√µes</option>
              </select></div>
            <button type="button" class="btn btn-primary" onclick="exportData()">üì• Exportar Dados</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="../static/scripts/auth.js"></script>
  <script src="../static/scripts/components.js"></script>
  <script>
    const reports = [
      { id: 1, titulo: "Relat√≥rio de Headcount", desc: "Vis√£o geral do quadro de funcion√°rios", icon: "üë•", categoria: "RH", ultima: "Hoje" },
      { id: 2, titulo: "An√°lise de Turnover", desc: "Taxa de rotatividade e motivos de desligamento", icon: "üìâ", categoria: "RH", ultima: "Ontem" },
      { id: 3, titulo: "Folha de Pagamento", desc: "Resumo mensal da folha", icon: "üí∞", categoria: "DP", ultima: "05/01" },
      { id: 4, titulo: "Banco de Horas", desc: "Saldo de horas por funcion√°rio", icon: "‚è∞", categoria: "DP", ultima: "Hoje" },
      { id: 5, titulo: "F√©rias Vencidas", desc: "Funcion√°rios com f√©rias a vencer", icon: "üèñÔ∏è", categoria: "DP", ultima: "03/01" },
      { id: 6, titulo: "Avalia√ß√µes de Desempenho", desc: "Resultados do ciclo atual", icon: "‚≠ê", categoria: "RH", ultima: "08/01" },
      { id: 7, titulo: "Treinamentos Conclu√≠dos", desc: "Relat√≥rio de capacita√ß√£o", icon: "üéì", categoria: "RH", ultima: "07/01" },
      { id: 8, titulo: "Custo de Benef√≠cios", desc: "An√°lise de custos por benef√≠cio", icon: "üéÅ", categoria: "DP", ultima: "01/01" },
      { id: 9, titulo: "Pipeline de Recrutamento", desc: "Status das vagas e candidatos", icon: "üìã", categoria: "RH", ultima: "Hoje" },
      { id: 10, titulo: "Absente√≠smo", desc: "Taxa de faltas e afastamentos", icon: "üìä", categoria: "DP", ultima: "06/01" }
    ];

    document.addEventListener("DOMContentLoaded", () => {
      if (!Auth.requireAuth()) return;
      initUI();
      initSidebar();
      render();
    });

    function initUI() {
      const user = Auth.getCurrentUser();
      document.getElementById("userName").textContent = user?.email?.split("@")[0] || "Usu√°rio";
      document.getElementById("userAvatar").textContent = (user?.email || "U")[0].toUpperCase();
      document.getElementById("userMenuButton").onclick = () => document.getElementById("userDropdown").classList.toggle("active");
      document.getElementById("logoutButton").onclick = (e) => { e.preventDefault(); Auth.logout(); };
    }

    function initSidebar() {
      const sidebar = document.getElementById('sidebar');
      const mobileBtn = document.getElementById('mobileMenuBtn');

      mobileBtn?.addEventListener('click', () => {
        sidebar.classList.toggle('mobile-open');
      });

      document.addEventListener('click', (e) => {
        if (window.innerWidth <= 768) {
          if (!e.target.closest('.sidebar') && !e.target.closest('.mobile-menu-btn')) {
            sidebar.classList.remove('mobile-open');
          }
        }
      });
    }

    function showTab(tab) {
      document.querySelectorAll('.tab-btn').forEach((b, i) => b.classList.toggle('active', ['dashboard', 'relatorios', 'exportar'][i] === tab));
      document.getElementById('tabDashboard').style.display = tab === 'dashboard' ? 'block' : 'none';
      document.getElementById('tabRelatorios').style.display = tab === 'relatorios' ? 'block' : 'none';
      document.getElementById('tabExportar').style.display = tab === 'exportar' ? 'block' : 'none';
    }

    function render() {
      document.getElementById("reportsGrid").innerHTML = reports.map(r => `
        <div class="report-card" onclick="generateReport(${r.id})">
          <div class="report-icon">${r.icon}</div>
          <h3 class="report-title">${r.titulo}</h3>
          <p class="report-desc">${r.desc}</p>
          <div class="report-meta">
            <span class="badge badge-info">${r.categoria}</span>
            <span>Atualizado: ${r.ultima}</span>
          </div>
        </div>
      `).join('');
    }

    function generateReport(id) {
      const report = reports.find(r => r.id === id);
      Toast.success(`Gerando relat√≥rio: ${report.titulo}`);
    }

    function exportData() {
      Toast.success('Exporta√ß√£o iniciada! O arquivo ser√° baixado em instantes.');
    }
  </script>
</body>

</html>