<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BenefÃ­cios - Sistema RH</title>
  <link rel="stylesheet" href="public/styles/global.css">
  <link rel="stylesheet" href="public/styles/dashboard.css">
  <link rel="stylesheet" href="public/styles/components.css">
</head>
<body>
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header"><div class="logo"><svg width="32" height="32" viewBox="0 0 48 48" fill="none"><rect width="48" height="48" rx="8" fill="#FFF"/><path d="M24 12C17.373 12 12 17.373 12 24C12 30.627 17.373 36 24 36C30.627 36 36 30.627 36 24C36 17.373 30.627 12 24 12ZM24 20C25.657 20 27 21.343 27 23C27 24.657 25.657 26 24 26C22.343 26 21 24.657 21 23C21 21.343 22.343 20 24 20ZM24 33.2C20.8 33.2 17.988 31.53 16.4 29C16.44 26.4 21.6 25 24 25C26.392 25 31.56 26.4 31.6 29C30.012 31.53 27.2 33.2 24 33.2Z" fill="#2c3e50"/></svg><span>Sistema RH</span></div></div>
    <nav class="sidebar-nav">
      <a href="dashboard.html" class="nav-item"><span class="nav-text">Dashboard</span></a>
      <div class="nav-section">GestÃ£o de Pessoas</div>
      <a href="employees.html" class="nav-item"><span class="nav-text">FuncionÃ¡rios</span></a>
      <a href="departments.html" class="nav-item"><span class="nav-text">Departamentos</span></a>
      <a href="positions.html" class="nav-item"><span class="nav-text">Cargos</span></a>
      <div class="nav-section">Recursos Humanos</div>
      <a href="recruitment.html" class="nav-item"><span class="nav-text">Recrutamento</span></a>
      <a href="training.html" class="nav-item"><span class="nav-text">Treinamentos</span></a>
      <a href="performance.html" class="nav-item"><span class="nav-text">AvaliaÃ§Ãµes</span></a>
      <div class="nav-section">Departamento Pessoal</div>
      <a href="payroll.html" class="nav-item"><span class="nav-text">Folha de Pagamento</span></a>
      <a href="benefits.html" class="nav-item active"><span class="nav-text">BenefÃ­cios</span></a>
      <a href="vacation.html" class="nav-item"><span class="nav-text">FÃ©rias</span></a>
      <a href="timesheet.html" class="nav-item"><span class="nav-text">Ponto</span></a>
      <div class="nav-section">AdministraÃ§Ã£o</div>
      <a href="reports.html" class="nav-item"><span class="nav-text">RelatÃ³rios</span></a>
      <a href="settings.html" class="nav-item"><span class="nav-text">ConfiguraÃ§Ãµes</span></a>
    </nav>
  </aside>

  <div class="main-content">
    <header class="topbar">
      <div class="topbar-left"><h1>BenefÃ­cios</h1></div>
      <div class="topbar-right"><div class="user-menu"><button class="user-button" id="userMenuButton"><span class="user-avatar" id="userAvatar">U</span><span class="user-name" id="userName">UsuÃ¡rio</span></button><div class="user-dropdown" id="userDropdown"><a href="#" class="dropdown-item" id="logoutButton">Sair</a></div></div></div>
    </header>

    <div class="content-area">
      <div class="stats-row">
        <div class="stat-box"><div class="stat-box-icon" style="background: rgba(44, 62, 80, 0.1);">ğŸ</div><div class="stat-box-value">6</div><div class="stat-box-label">Tipos de BenefÃ­cios</div></div>
        <div class="stat-box"><div class="stat-box-icon" style="background: rgba(39, 174, 96, 0.1);">ğŸ‘¥</div><div class="stat-box-value">248</div><div class="stat-box-label">BeneficiÃ¡rios</div></div>
        <div class="stat-box"><div class="stat-box-icon" style="background: rgba(243, 156, 18, 0.1);">ğŸ’°</div><div class="stat-box-value">R$ 185K</div><div class="stat-box-label">Custo Mensal</div></div>
        <div class="stat-box"><div class="stat-box-icon" style="background: rgba(231, 76, 60, 0.1);">ğŸ“Š</div><div class="stat-box-value">R$ 745</div><div class="stat-box-label">Custo/FuncionÃ¡rio</div></div>
      </div>

      <div class="page-header">
        <div><h2 class="page-title">GestÃ£o de BenefÃ­cios</h2><p class="page-subtitle">Configure e gerencie os benefÃ­cios oferecidos</p></div>
        <div class="page-actions"><button class="btn btn-primary" onclick="openModal()">+ Novo BenefÃ­cio</button></div>
      </div>

      <div class="departments-grid" id="benefitsGrid"></div>
    </div>
  </div>

  <div class="modal" id="modal">
    <div class="modal-dialog modal-md">
      <div class="modal-header"><h3 class="modal-title" id="modalTitle">Novo BenefÃ­cio</h3><button class="modal-close" onclick="Modal.close('modal')">&times;</button></div>
      <div class="modal-body">
        <form id="form">
          <input type="hidden" name="id">
          <div class="form-group"><label class="form-label">Nome do BenefÃ­cio *</label><input type="text" class="form-input" name="nome" required></div>
          <div class="form-group"><label class="form-label">DescriÃ§Ã£o</label><textarea class="form-input" name="descricao" rows="2"></textarea></div>
          <div class="form-row form-row-2">
            <div class="form-group"><label class="form-label">Valor PadrÃ£o</label><input type="text" class="form-input" name="valor" data-mask="currency"></div>
            <div class="form-group"><label class="form-label">Desconto em Folha?</label><select class="form-select" name="desconto"><option value="true">Sim</option><option value="false">NÃ£o</option></select></div>
          </div>
          <div class="form-group"><label class="checkbox-label"><input type="checkbox" name="ativo" checked><span>BenefÃ­cio Ativo</span></label></div>
        </form>
      </div>
      <div class="modal-footer"><button class="btn btn-secondary" onclick="Modal.close('modal')">Cancelar</button><button class="btn btn-primary" onclick="save()">Salvar</button></div>
    </div>
  </div>

  <style>.departments-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:var(--spacing-4)}.benefit-card{background:white;border-radius:var(--radius-lg);padding:var(--spacing-5);box-shadow:var(--shadow-sm);border:1px solid var(--gray-200)}.benefit-header{display:flex;justify-content:space-between;margin-bottom:var(--spacing-3)}.benefit-icon{width:48px;height:48px;background:var(--gray-100);border-radius:var(--radius-md);display:flex;align-items:center;justify-content:center;font-size:24px}.benefit-name{font-size:var(--font-size-lg);font-weight:600;margin-bottom:var(--spacing-1)}.benefit-desc{font-size:var(--font-size-sm);color:var(--gray-500);margin-bottom:var(--spacing-3)}.benefit-stats{display:flex;justify-content:space-between;padding-top:var(--spacing-3);border-top:1px solid var(--gray-100);font-size:var(--font-size-sm)}</style>

  <script src="public/scripts/auth.js"></script>
  <script src="public/scripts/components.js"></script>
  <script>
    const benefits = [
      { id: 1, nome: "Vale RefeiÃ§Ã£o", descricao: "CartÃ£o para refeiÃ§Ãµes diÃ¡rias", valor: 800, beneficiarios: 235, icon: "ğŸ½ï¸", ativo: true },
      { id: 2, nome: "Vale Transporte", descricao: "AuxÃ­lio para deslocamento", valor: 300, beneficiarios: 180, icon: "ğŸšŒ", ativo: true },
      { id: 3, nome: "Plano de SaÃºde", descricao: "AssistÃªncia mÃ©dica completa", valor: 650, beneficiarios: 248, icon: "ğŸ¥", ativo: true },
      { id: 4, nome: "Plano OdontolÃ³gico", descricao: "Cobertura odontolÃ³gica", valor: 80, beneficiarios: 220, icon: "ğŸ¦·", ativo: true },
      { id: 5, nome: "Seguro de Vida", descricao: "ProteÃ§Ã£o para famÃ­lia", valor: 50, beneficiarios: 248, icon: "ğŸ›¡ï¸", ativo: true },
      { id: 6, nome: "Gympass", descricao: "Acesso a academias parceiras", valor: 100, beneficiarios: 85, icon: "ğŸ‹ï¸", ativo: true }
    ];
    let currentId = null;

    document.addEventListener("DOMContentLoaded", () => {
      if (!Auth.requireAuth()) return;
      initUI(); render(); Mask.initAll();
    });

    function initUI() {
      const user = Auth.getCurrentUser();
      document.getElementById("userName").textContent = user?.email?.split("@")[0] || "UsuÃ¡rio";
      document.getElementById("userAvatar").textContent = (user?.email || "U")[0].toUpperCase();
      document.getElementById("userMenuButton").onclick = () => document.getElementById("userDropdown").classList.toggle("active");
      document.getElementById("logoutButton").onclick = (e) => { e.preventDefault(); Auth.logout(); };
    }

    function render() {
      document.getElementById("benefitsGrid").innerHTML = benefits.map(b => `
        <div class="benefit-card">
          <div class="benefit-header">
            <div class="benefit-icon">${b.icon}</div>
            <div class="cell-actions">
              <button class="btn-icon edit" onclick="edit(${b.id})">âœï¸</button>
              <button class="btn-icon delete" onclick="remove(${b.id})">ğŸ—‘ï¸</button>
            </div>
          </div>
          <h3 class="benefit-name">${b.nome}</h3>
          <p class="benefit-desc">${b.descricao}</p>
          <div class="benefit-stats">
            <span><strong>${b.beneficiarios}</strong> beneficiÃ¡rios</span>
            <span><strong>${formatCurrency(b.valor)}</strong>/mÃªs</span>
          </div>
        </div>
      `).join('');
    }

    function openModal(id = null) {
      currentId = id;
      document.getElementById("form").reset();
      document.getElementById("modalTitle").textContent = id ? "Editar BenefÃ­cio" : "Novo BenefÃ­cio";
      if (id) { const item = benefits.find(b => b.id === id); if (item) Form.populate('form', item); }
      Modal.open('modal'); Mask.initAll();
    }

    function edit(id) { openModal(id); }
    function save() { const data = Form.serialize('form'); if (!data.nome) { Toast.error('Nome obrigatÃ³rio'); return; } if (currentId) { const idx = benefits.findIndex(b => b.id === currentId); if (idx > -1) benefits[idx] = { ...benefits[idx], ...data }; Toast.success('BenefÃ­cio atualizado!'); } else { benefits.push({ id: Date.now(), ...data, beneficiarios: 0, icon: 'ğŸ' }); Toast.success('BenefÃ­cio criado!'); } Modal.close('modal'); render(); }
    function remove(id) { Confirm.show('Excluir este benefÃ­cio?', () => { const idx = benefits.findIndex(b => b.id === id); if (idx > -1) benefits.splice(idx, 1); Toast.success('BenefÃ­cio excluÃ­do!'); render(); }); }
    function formatCurrency(val) { return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(val || 0); }
  </script>
</body>
</html>
