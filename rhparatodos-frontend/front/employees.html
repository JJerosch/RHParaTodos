<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Funcionários - Sistema RH</title>
  <link rel="stylesheet" href="public/styles/global.css">
  <link rel="stylesheet" href="public/styles/dashboard.css">
  <link rel="stylesheet" href="public/styles/components.css">
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="logo">
        <img src="/front/public/assets/gruporhpaint.png" alt="logo_menu_lateral" height="60">  
      </div>
    </div>

    <nav class="sidebar-nav">
      <a href="dashboard.html" class="nav-item">
        <span class="nav-text">Dashboard</span>
      </a>
      
      <div class="nav-section">Gestão de Pessoas</div>
      <a href="employees.html" class="nav-item active">
        <span class="nav-text">Funcionários</span>
      </a>
      <a href="departments.html" class="nav-item">
        <span class="nav-text">Departamentos</span>
      </a>
      <a href="positions.html" class="nav-item">
        <span class="nav-text">Cargos</span>
      </a>
      
      <div class="nav-section">Recursos Humanos</div>
      <a href="recruitment.html" class="nav-item">
        <span class="nav-text">Recrutamento</span>
      </a>
      <a href="training.html" class="nav-item">
        <span class="nav-text">Treinamentos</span>
      </a>
      <a href="performance.html" class="nav-item">
        <span class="nav-text">Avaliações</span>
      </a>
      
      <div class="nav-section">Departamento Pessoal</div>
      <a href="payroll.html" class="nav-item">
        <span class="nav-text">Folha de Pagamento</span>
      </a>
      <a href="benefits.html" class="nav-item">
        <span class="nav-text">Benefícios</span>
      </a>
      <a href="vacation.html" class="nav-item">
        <span class="nav-text">Férias</span>
      </a>
      <a href="timesheet.html" class="nav-item">
        <span class="nav-text">Ponto</span>
      </a>
      
      <div class="nav-section">Administração</div>
      <a href="reports.html" class="nav-item">
        <span class="nav-text">Relatórios</span>
      </a>
      <a href="settings.html" class="nav-item">
        <span class="nav-text">Configurações</span>
      </a>
    </nav>
  </aside>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Topbar -->
    <header class="topbar">
      <div class="topbar-left">
        <button class="mobile-menu-btn" id="mobileMenuBtn">☰</button>
        <h1>Funcionários</h1>
      </div>
      <div class="topbar-right">
        <div class="user-menu">
          <button class="user-button" id="userMenuButton">
            <span class="user-avatar" id="userAvatar">U</span>
            <span class="user-name" id="userName">Usuário</span>
            <span class="user-arrow">▼</span>
          </button>
          <div class="user-dropdown" id="userDropdown">
            <div class="user-info">
              <strong id="userFullName">Nome do Usuário</strong>
              <small id="userProfile">Perfil</small>
            </div>
            <hr>
            <a href="#" class="dropdown-item">Meu Perfil</a>
            <a href="settings.html" class="dropdown-item">Configurações</a>
            <hr>
            <a href="#" class="dropdown-item" id="logoutButton">Sair</a>
          </div>
        </div>
      </div>
    </header>

    <!-- Content Area -->
    <div class="content-area">
      <!-- Stats -->
      <div class="stats-row">
        <div class="stat-box">
          <div class="stat-box-header">
            <div class="stat-box-icon" style="background: rgba(44, 62, 80, 0.1); color: var(--primary-dark);"><img src="/front/public/assets/id-card-lanyard (1).png" alt="icone_funcionarios"></div>
          </div>
          <div class="stat-box-value" id="statTotal">0</div>
          <div class="stat-box-label">Total de Funcionários</div>
        </div>
        <div class="stat-box">
          <div class="stat-box-header">
            <div class="stat-box-icon" style="background: rgba(39, 174, 96, 0.1); color: var(--success-green);"><img src="/front/public/assets/check (1).png" alt="icone_funcionarios_ativos"></div>
          </div>
          <div class="stat-box-value" id="statAtivos">0</div>
          <div class="stat-box-label">Ativos</div>
        </div>
        <div class="stat-box">
          <div class="stat-box-header">
            <div class="stat-box-icon" style="background: rgba(243, 156, 18, 0.1); color: var(--warning-orange);"><img src="/front/public/assets/hourglass.png" alt="icone_funcionarios_ferias"></div>
          </div>
          <div class="stat-box-value" id="statFerias">0</div>
          <div class="stat-box-label">Em Férias</div>
        </div>
        <div class="stat-box">
          <div class="stat-box-header">
            <div class="stat-box-icon" style="background: rgba(231, 76, 60, 0.1); color: var(--error-red);"><img src="/front/public/assets/door-open.png" alt="icone_funcionarios_desligados"></div>
          </div>
          <div class="stat-box-value" id="statDesligados">0</div>
          <div class="stat-box-label">Desligados (mês)</div>
        </div>
      </div>

      <!-- Page Header -->
      <div class="page-header">
        <div>
          <h2 class="page-title">Lista de Funcionários</h2>
          <p class="page-subtitle">Gerencie todos os funcionários da empresa</p>
        </div>
        <div class="page-actions">
          <button class="btn btn-secondary" onclick="exportEmployees()">
            <img src="/front/public/assets/folder-output.png" alt="icone_exportar"> Exportar
          </button>
          <button class="btn btn-primary" onclick="openEmployeeModal()">
            <img src="/front/public/assets/plus.png" alt="icone_novo_funcionarios"> Novo Funcionário
          </button>
        </div>
      </div>

      <!-- Filters -->
      <div class="filters-bar">
        <div class="search-box">
          <input type="text" id="searchInput" placeholder="Buscar por nome, matrícula ou CPF..." onkeyup="filterEmployees()">
        </div>
        <div class="filter-group">
          <label>Departamento:</label>
          <select id="filterDepartment" onchange="filterEmployees()">
            <option value="">Todos</option>
            <option value="TI">Tecnologia</option>
            <option value="RH">Recursos Humanos</option>
            <option value="Financeiro">Financeiro</option>
            <option value="Comercial">Comercial</option>
            <option value="Operações">Operações</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Status:</label>
          <select id="filterStatus" onchange="filterEmployees()">
            <option value="">Todos</option>
            <option value="ATIVO">Ativo</option>
            <option value="FERIAS">Em Férias</option>
            <option value="AFASTADO">Afastado</option>
            <option value="DESLIGADO">Desligado</option>
          </select>
        </div>
      </div>

      <!-- Table -->
      <div class="table-container">
        <table class="data-table" id="employeesTable">
          <thead>
            <tr>
              <th class="sortable" onclick="sortTable(0)">Funcionário</th>
              <th class="sortable" onclick="sortTable(1)">Matrícula</th>
              <th class="sortable hide-mobile" onclick="sortTable(2)">Departamento</th>
              <th class="sortable hide-mobile" onclick="sortTable(3)">Cargo</th>
              <th class="sortable hide-mobile" onclick="sortTable(4)">Admissão</th>
              <th>Status</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody id="employeesTableBody">
            <!-- Data will be loaded here -->
          </tbody>
        </table>

        <div class="table-footer">
          <div class="per-page">
            <span>Exibir</span>
            <select id="perPage" onchange="changePerPage()">
              <option value="10">10</option>
              <option value="25">25</option>
              <option value="50">50</option>
              <option value="100">100</option>
            </select>
            <span>por página</span>
          </div>
          <div class="table-info" id="tableInfo">Mostrando 0 de 0 resultados</div>
          <div class="pagination" id="pagination">
            <!-- Pagination will be generated -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: Novo/Editar Funcionário -->
  <div class="modal" id="employeeModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-header">
        <h3 class="modal-title" id="modalTitle">Novo Funcionário</h3>
        <button class="modal-close" onclick="Modal.close('employeeModal')">&times;</button>
      </div>
      <div class="modal-body">
        <form id="employeeForm">
          <input type="hidden" id="employeeId" name="id">
          
          <!-- Tabs -->
          <div class="tabs" data-tab-content="employeeTabs">
            <button type="button" class="tab-btn active" data-tab="dados">Dados Pessoais</button>
            <button type="button" class="tab-btn" data-tab="contato">Contato</button>
            <button type="button" class="tab-btn" data-tab="profissional">Dados Profissionais</button>
            <button type="button" class="tab-btn" data-tab="bancario">Dados Bancários</button>
          </div>

          <div id="employeeTabs">
            <!-- Tab: Dados Pessoais -->
            <div class="tab-content active" data-tab-content="dados">
              <div class="form-section">
                <h4 class="form-section-title">Informações Básicas</h4>
                <div class="form-row form-row-2">
                  <div class="form-group">
                    <label class="form-label">Nome Completo *</label>
                    <input type="text" class="form-input" name="nome_completo" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label">CPF *</label>
                    <input type="text" class="form-input" name="cpf" data-mask="cpf" required>
                  </div>
                </div>
                <div class="form-row form-row-3">
                  <div class="form-group">
                    <label class="form-label">RG</label>
                    <input type="text" class="form-input" name="rg">
                  </div>
                  <div class="form-group">
                    <label class="form-label">Data de Nascimento *</label>
                    <input type="date" class="form-input" name="data_nascimento" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Gênero</label>
                    <select class="form-select" name="genero">
                      <option value="">Selecione</option>
                      <option value="M">Masculino</option>
                      <option value="F">Feminino</option>
                      <option value="O">Outro</option>
                      <option value="N">Prefiro não informar</option>
                    </select>
                  </div>
                </div>
                <div class="form-row form-row-2">
                  <div class="form-group">
                    <label class="form-label">Estado Civil</label>
                    <select class="form-select" name="estado_civil">
                      <option value="">Selecione</option>
                      <option value="SOLTEIRO">Solteiro(a)</option>
                      <option value="CASADO">Casado(a)</option>
                      <option value="DIVORCIADO">Divorciado(a)</option>
                      <option value="VIUVO">Viúvo(a)</option>
                      <option value="UNIAO_ESTAVEL">União Estável</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Nacionalidade</label>
                    <input type="text" class="form-input" name="nacionalidade" value="Brasileiro(a)">
                  </div>
                </div>
              </div>
            </div>

            <!-- Tab: Contato -->
            <div class="tab-content" data-tab-content="contato">
              <div class="form-section">
                <h4 class="form-section-title">Contato</h4>
                <div class="form-row form-row-2">
                  <div class="form-group">
                    <label class="form-label">Email Pessoal</label>
                    <input type="email" class="form-input" name="email_pessoal">
                  </div>
                  <div class="form-group">
                    <label class="form-label">Email Corporativo</label>
                    <input type="email" class="form-input" name="email_corporativo">
                  </div>
                </div>
                <div class="form-row form-row-2">
                  <div class="form-group">
                    <label class="form-label">Telefone</label>
                    <input type="text" class="form-input" name="telefone" data-mask="phone">
                  </div>
                  <div class="form-group">
                    <label class="form-label">Celular</label>
                    <input type="text" class="form-input" name="celular" data-mask="phone">
                  </div>
                </div>
              </div>

              <div class="form-section">
                <h4 class="form-section-title">Endereço</h4>
                <div class="form-row form-row-3">
                  <div class="form-group">
                    <label class="form-label">CEP</label>
                    <input type="text" class="form-input" name="cep" data-mask="cep" onblur="searchCEP(this.value)">
                  </div>
                  <div class="form-group" style="grid-column: span 2;">
                    <label class="form-label">Logradouro</label>
                    <input type="text" class="form-input" name="logradouro" id="logradouro">
                  </div>
                </div>
                <div class="form-row form-row-3">
                  <div class="form-group">
                    <label class="form-label">Número</label>
                    <input type="text" class="form-input" name="numero">
                  </div>
                  <div class="form-group">
                    <label class="form-label">Complemento</label>
                    <input type="text" class="form-input" name="complemento">
                  </div>
                  <div class="form-group">
                    <label class="form-label">Bairro</label>
                    <input type="text" class="form-input" name="bairro" id="bairro">
                  </div>
                </div>
                <div class="form-row form-row-2">
                  <div class="form-group">
                    <label class="form-label">Cidade</label>
                    <input type="text" class="form-input" name="cidade" id="cidade">
                  </div>
                  <div class="form-group">
                    <label class="form-label">Estado</label>
                    <select class="form-select" name="estado" id="estado">
                      <option value="">Selecione</option>
                      <option value="AC">Acre</option>
                      <option value="AL">Alagoas</option>
                      <option value="AP">Amapá</option>
                      <option value="AM">Amazonas</option>
                      <option value="BA">Bahia</option>
                      <option value="CE">Ceará</option>
                      <option value="DF">Distrito Federal</option>
                      <option value="ES">Espírito Santo</option>
                      <option value="GO">Goiás</option>
                      <option value="MA">Maranhão</option>
                      <option value="MT">Mato Grosso</option>
                      <option value="MS">Mato Grosso do Sul</option>
                      <option value="MG">Minas Gerais</option>
                      <option value="PA">Pará</option>
                      <option value="PB">Paraíba</option>
                      <option value="PR">Paraná</option>
                      <option value="PE">Pernambuco</option>
                      <option value="PI">Piauí</option>
                      <option value="RJ">Rio de Janeiro</option>
                      <option value="RN">Rio Grande do Norte</option>
                      <option value="RS">Rio Grande do Sul</option>
                      <option value="RO">Rondônia</option>
                      <option value="RR">Roraima</option>
                      <option value="SC">Santa Catarina</option>
                      <option value="SP">São Paulo</option>
                      <option value="SE">Sergipe</option>
                      <option value="TO">Tocantins</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <!-- Tab: Dados Profissionais -->
            <div class="tab-content" data-tab-content="profissional">
              <div class="form-section">
                <h4 class="form-section-title">Informações Profissionais</h4>
                <div class="form-row form-row-2">
                  <div class="form-group">
                    <label class="form-label">Matrícula *</label>
                    <input type="text" class="form-input" name="matricula" required>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Data de Admissão *</label>
                    <input type="date" class="form-input" name="data_admissao" required>
                  </div>
                </div>
                <div class="form-row form-row-2">
                  <div class="form-group">
                    <label class="form-label">Departamento *</label>
                    <select class="form-select" name="departamento_id" required>
                      <option value="">Selecione</option>
                      <option value="1">Tecnologia</option>
                      <option value="2">Recursos Humanos</option>
                      <option value="3">Financeiro</option>
                      <option value="4">Comercial</option>
                      <option value="5">Operações</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Cargo *</label>
                    <select class="form-select" name="cargo_id" required>
                      <option value="">Selecione</option>
                      <option value="1">Analista</option>
                      <option value="2">Desenvolvedor</option>
                      <option value="3">Coordenador</option>
                      <option value="4">Gerente</option>
                      <option value="5">Diretor</option>
                    </select>
                  </div>
                </div>
                <div class="form-row form-row-3">
                  <div class="form-group">
                    <label class="form-label">Tipo de Contrato</label>
                    <select class="form-select" name="tipo_contrato">
                      <option value="CLT">CLT</option>
                      <option value="PJ">PJ</option>
                      <option value="ESTAGIO">Estágio</option>
                      <option value="TEMPORARIO">Temporário</option>
                      <option value="APRENDIZ">Jovem Aprendiz</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Salário</label>
                    <input type="text" class="form-input" name="salario_atual" data-mask="currency">
                  </div>
                  <div class="form-group">
                    <label class="form-label">Status</label>
                    <select class="form-select" name="status">
                      <option value="ATIVO">Ativo</option>
                      <option value="FERIAS">Em Férias</option>
                      <option value="AFASTADO">Afastado</option>
                      <option value="DESLIGADO">Desligado</option>
                    </select>
                  </div>
                </div>
                <div class="form-row form-row-2">
                  <div class="form-group">
                    <label class="form-label">Gestor Direto</label>
                    <select class="form-select" name="gestor_id">
                      <option value="">Selecione</option>
                      <!-- Will be loaded dynamically -->
                    </select>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Centro de Custo</label>
                    <input type="text" class="form-input" name="centro_custo">
                  </div>
                </div>
              </div>
            </div>

            <!-- Tab: Dados Bancários -->
            <div class="tab-content" data-tab-content="bancario">
              <div class="form-section">
                <h4 class="form-section-title">Dados Bancários</h4>
                <div class="form-row form-row-2">
                  <div class="form-group">
                    <label class="form-label">Banco</label>
                    <select class="form-select" name="banco">
                      <option value="">Selecione</option>
                      <option value="001">Banco do Brasil</option>
                      <option value="033">Santander</option>
                      <option value="104">Caixa Econômica</option>
                      <option value="237">Bradesco</option>
                      <option value="341">Itaú</option>
                      <option value="756">Sicoob</option>
                      <option value="260">Nubank</option>
                      <option value="077">Inter</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label class="form-label">Tipo de Conta</label>
                    <select class="form-select" name="tipo_conta">
                      <option value="">Selecione</option>
                      <option value="CORRENTE">Conta Corrente</option>
                      <option value="POUPANCA">Poupança</option>
                      <option value="SALARIO">Conta Salário</option>
                    </select>
                  </div>
                </div>
                <div class="form-row form-row-2">
                  <div class="form-group">
                    <label class="form-label">Agência</label>
                    <input type="text" class="form-input" name="agencia">
                  </div>
                  <div class="form-group">
                    <label class="form-label">Conta</label>
                    <input type="text" class="form-input" name="conta">
                  </div>
                </div>
                <div class="form-group">
                  <label class="form-label">Chave PIX</label>
                  <input type="text" class="form-input" name="pix" placeholder="CPF, Email, Telefone ou Chave aleatória">
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="Modal.close('employeeModal')">Cancelar</button>
        <button type="button" class="btn btn-primary" onclick="saveEmployee()">Salvar</button>
      </div>
    </div>
  </div>

  <!-- Modal: Visualizar Funcionário -->
  <div class="modal" id="viewEmployeeModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-header">
        <h3 class="modal-title">Detalhes do Funcionário</h3>
        <button class="modal-close" onclick="Modal.close('viewEmployeeModal')">&times;</button>
      </div>
      <div class="modal-body" id="viewEmployeeContent">
        <!-- Content will be loaded dynamically -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" onclick="Modal.close('viewEmployeeModal')">Fechar</button>
        <button type="button" class="btn btn-primary" onclick="editFromView()">Editar</button>
      </div>
    </div>
  </div>

  <script src="public/scripts/auth.js"></script>
  <script src="public/scripts/components.js"></script>
  <script src="public/scripts/employees.js"></script>
</body>
</html>
